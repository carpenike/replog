{{ define "title" }}RepLog â€” Preferences{{ end }}

{{ define "content" }}
        <div class="breadcrumb">
            <a href="/">Home</a> &rsaquo; Preferences
        </div>

        <h1>Preferences</h1>

        {{ if .Success }}
        <div class="alert alert-success" role="alert">Preferences saved successfully.</div>
        {{ end }}

        {{ if .Error }}
        <div class="alert alert-error" role="alert">{{ .Error }}</div>
        {{ end }}

        <section>
            <h2>Avatar</h2>
            <div class="avatar-settings">
                <div class="avatar-preview">
                    {{ if and .AvatarUser .AvatarUser.HasAvatar }}
                    <img src="{{ .AvatarUser.AvatarURL }}" alt="Your avatar" class="avatar-img avatar-img--lg">
                    {{ else }}
                    <div class="avatar-placeholder avatar-placeholder--lg">{{ userInitials (displayName .User) }}</div>
                    {{ end }}
                </div>
            </div>
        </section>

        <hr>

        <form method="POST" action="/preferences">
            <label for="weight_unit">Weight Unit
                <select id="weight_unit" name="weight_unit">
                    {{ $currentUnit := "" }}
                    {{ if .EditPrefs }}{{ $currentUnit = .EditPrefs.WeightUnit }}{{ end }}
                    {{ range .WeightUnits }}
                    <option value="{{ . }}" {{ if eq . $currentUnit }}selected{{ end }}>{{ . }}</option>
                    {{ end }}
                </select>
            </label>

            <label for="timezone">Timezone
                <select id="timezone" name="timezone">
                    {{ $currentTZ := "" }}
                    {{ if .EditPrefs }}{{ $currentTZ = .EditPrefs.Timezone }}{{ end }}
                    {{ range .CommonTimezones }}
                    <option value="{{ . }}" {{ if eq . $currentTZ }}selected{{ end }}>{{ . }}</option>
                    {{ end }}
                </select>
            </label>

            <label for="date_format">Date Format
                <select id="date_format" name="date_format">
                    {{ $currentFmt := "" }}
                    {{ if .EditPrefs }}{{ $currentFmt = .EditPrefs.DateFormat }}{{ end }}
                    {{ range $format, $label := .DateFormats }}
                    <option value="{{ $format }}" {{ if eq $format $currentFmt }}selected{{ end }}>{{ $label }}</option>
                    {{ end }}
                </select>
            </label>

            <div class="form-actions">
                <button type="submit">Save Preferences</button>
                <a href="/" role="button" class="secondary">Cancel</a>
            </div>
        </form>
{{ end }}
